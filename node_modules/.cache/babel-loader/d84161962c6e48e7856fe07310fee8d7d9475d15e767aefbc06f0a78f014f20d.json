{"ast":null,"code":"import _slicedToArray from \"/Users/kyleloudin/Desktop/repo/vuetify-todo/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";\nimport _createForOfIteratorHelper from \"/Users/kyleloudin/Desktop/repo/vuetify-todo/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";\nimport _toConsumableArray from \"/Users/kyleloudin/Desktop/repo/vuetify-todo/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";\nimport _objectSpread from \"/Users/kyleloudin/Desktop/repo/vuetify-todo/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.set.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.for-each.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.array.reduce.js\";\nimport \"core-js/modules/es.map.js\";\nimport \"core-js/modules/es.function.bind.js\";\n// Styles\nimport \"../../../src/components/VTreeview/VTreeview.sass\"; // Components\n\nimport VTreeviewNode, { VTreeviewNodeProps } from './VTreeviewNode'; // Mixins\n\nimport Themeable from '../../mixins/themeable';\nimport { provide as RegistrableProvide } from '../../mixins/registrable'; // Utils\n\nimport { arrayDiff, deepEqual, getObjectValueByPath } from '../../util/helpers';\nimport mixins from '../../util/mixins';\nimport { consoleWarn } from '../../util/console';\nimport { filterTreeItems, filterTreeItem } from './util/filterTreeItems';\nexport default mixins(RegistrableProvide('treeview'), Themeable\n/* @vue/component */).extend({\n  name: 'v-treeview',\n  provide: function provide() {\n    return {\n      treeview: this\n    };\n  },\n  props: _objectSpread({\n    active: {\n      type: Array,\n      \"default\": function _default() {\n        return [];\n      }\n    },\n    dense: Boolean,\n    disabled: Boolean,\n    filter: Function,\n    hoverable: Boolean,\n    items: {\n      type: Array,\n      \"default\": function _default() {\n        return [];\n      }\n    },\n    multipleActive: Boolean,\n    open: {\n      type: Array,\n      \"default\": function _default() {\n        return [];\n      }\n    },\n    openAll: Boolean,\n    returnObject: {\n      type: Boolean,\n      \"default\": false // TODO: Should be true in next major\n    },\n\n    search: String,\n    value: {\n      type: Array,\n      \"default\": function _default() {\n        return [];\n      }\n    }\n  }, VTreeviewNodeProps),\n  data: function data() {\n    return {\n      level: -1,\n      activeCache: new Set(),\n      nodes: {},\n      openCache: new Set(),\n      selectedCache: new Set()\n    };\n  },\n  computed: {\n    excludedItems: function excludedItems() {\n      var excluded = new Set();\n      if (!this.search) return excluded;\n      for (var i = 0; i < this.items.length; i++) {\n        filterTreeItems(this.filter || filterTreeItem, this.items[i], this.search, this.itemKey, this.itemText, this.itemChildren, excluded);\n      }\n      return excluded;\n    }\n  },\n  watch: {\n    items: {\n      handler: function handler() {\n        var _this = this;\n        var oldKeys = Object.keys(this.nodes).map(function (k) {\n          return getObjectValueByPath(_this.nodes[k].item, _this.itemKey);\n        });\n        var newKeys = this.getKeys(this.items);\n        var diff = arrayDiff(newKeys, oldKeys); // We only want to do stuff if items have changed\n\n        if (!diff.length && newKeys.length < oldKeys.length) return; // If nodes are removed we need to clear them from this.nodes\n\n        diff.forEach(function (k) {\n          return delete _this.nodes[k];\n        });\n        var oldSelectedCache = _toConsumableArray(this.selectedCache);\n        this.selectedCache = new Set();\n        this.activeCache = new Set();\n        this.openCache = new Set();\n        this.buildTree(this.items); // Only emit selected if selection has changed\n        // as a result of items changing. This fixes a\n        // potential double emit when selecting a node\n        // with dynamic children\n\n        if (!deepEqual(oldSelectedCache, _toConsumableArray(this.selectedCache))) this.emitSelected();\n      },\n      deep: true\n    },\n    active: function active(value) {\n      this.handleNodeCacheWatcher(value, this.activeCache, this.updateActive, this.emitActive);\n    },\n    value: function value(_value) {\n      this.handleNodeCacheWatcher(_value, this.selectedCache, this.updateSelected, this.emitSelected);\n    },\n    open: function open(value) {\n      this.handleNodeCacheWatcher(value, this.openCache, this.updateOpen, this.emitOpen);\n    }\n  },\n  created: function created() {\n    var _this2 = this;\n    var getValue = function getValue(key) {\n      return _this2.returnObject ? getObjectValueByPath(key, _this2.itemKey) : key;\n    };\n    this.buildTree(this.items);\n    var _iterator = _createForOfIteratorHelper(this.value.map(getValue)),\n      _step;\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var value = _step.value;\n        this.updateSelected(value, true, true);\n      }\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n    var _iterator2 = _createForOfIteratorHelper(this.active.map(getValue)),\n      _step2;\n    try {\n      for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n        var active = _step2.value;\n        this.updateActive(active, true);\n      }\n    } catch (err) {\n      _iterator2.e(err);\n    } finally {\n      _iterator2.f();\n    }\n  },\n  mounted: function mounted() {\n    var _this3 = this;\n    // Save the developer from themselves\n    if (this.$slots.prepend || this.$slots.append) {\n      consoleWarn('The prepend and append slots require a slot-scope attribute', this);\n    }\n    if (this.openAll) {\n      this.updateAll(true);\n    } else {\n      this.open.forEach(function (key) {\n        return _this3.updateOpen(_this3.returnObject ? getObjectValueByPath(key, _this3.itemKey) : key, true);\n      });\n      this.emitOpen();\n    }\n  },\n  methods: {\n    /** @public */updateAll: function updateAll(value) {\n      var _this4 = this;\n      Object.keys(this.nodes).forEach(function (key) {\n        return _this4.updateOpen(getObjectValueByPath(_this4.nodes[key].item, _this4.itemKey), value);\n      });\n      this.emitOpen();\n    },\n    getKeys: function getKeys(items) {\n      var keys = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      for (var i = 0; i < items.length; i++) {\n        var key = getObjectValueByPath(items[i], this.itemKey);\n        keys.push(key);\n        var children = getObjectValueByPath(items[i], this.itemChildren);\n        if (children) {\n          keys.push.apply(keys, _toConsumableArray(this.getKeys(children)));\n        }\n      }\n      return keys;\n    },\n    buildTree: function buildTree(items) {\n      var _this5 = this;\n      var parent = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      var _a;\n      for (var i = 0; i < items.length; i++) {\n        var item = items[i];\n        var key = getObjectValueByPath(item, this.itemKey);\n        var children = (_a = getObjectValueByPath(item, this.itemChildren)) !== null && _a !== void 0 ? _a : [];\n        var oldNode = this.nodes.hasOwnProperty(key) ? this.nodes[key] : {\n          isSelected: false,\n          isIndeterminate: false,\n          isActive: false,\n          isOpen: false,\n          vnode: null\n        };\n        var node = {\n          vnode: oldNode.vnode,\n          parent: parent,\n          children: children.map(function (c) {\n            return getObjectValueByPath(c, _this5.itemKey);\n          }),\n          item: item\n        };\n        this.buildTree(children, key); // This fixed bug with dynamic children resetting selected parent state\n\n        if (this.selectionType !== 'independent' && parent !== null && !this.nodes.hasOwnProperty(key) && this.nodes.hasOwnProperty(parent)) {\n          node.isSelected = this.nodes[parent].isSelected;\n        } else {\n          node.isSelected = oldNode.isSelected;\n          node.isIndeterminate = oldNode.isIndeterminate;\n        }\n        node.isActive = oldNode.isActive;\n        node.isOpen = oldNode.isOpen;\n        this.nodes[key] = node;\n        if (children.length && this.selectionType !== 'independent') {\n          var _this$calculateState = this.calculateState(key, this.nodes),\n            isSelected = _this$calculateState.isSelected,\n            isIndeterminate = _this$calculateState.isIndeterminate;\n          node.isSelected = isSelected;\n          node.isIndeterminate = isIndeterminate;\n        } // Don't forget to rebuild cache\n\n        if (this.nodes[key].isSelected && (this.selectionType === 'independent' || node.children.length === 0)) this.selectedCache.add(key);\n        if (this.nodes[key].isActive) this.activeCache.add(key);\n        if (this.nodes[key].isOpen) this.openCache.add(key);\n        this.updateVnodeState(key);\n      }\n    },\n    calculateState: function calculateState(node, state) {\n      var children = state[node].children;\n      var counts = children.reduce(function (counts, child) {\n        counts[0] += +Boolean(state[child].isSelected);\n        counts[1] += +Boolean(state[child].isIndeterminate);\n        return counts;\n      }, [0, 0]);\n      var isSelected = !!children.length && counts[0] === children.length;\n      var isIndeterminate = !isSelected && (counts[0] > 0 || counts[1] > 0);\n      return {\n        isSelected: isSelected,\n        isIndeterminate: isIndeterminate\n      };\n    },\n    emitOpen: function emitOpen() {\n      this.emitNodeCache('update:open', this.openCache);\n    },\n    emitSelected: function emitSelected() {\n      this.emitNodeCache('input', this.selectedCache);\n    },\n    emitActive: function emitActive() {\n      this.emitNodeCache('update:active', this.activeCache);\n    },\n    emitNodeCache: function emitNodeCache(event, cache) {\n      var _this6 = this;\n      this.$emit(event, this.returnObject ? _toConsumableArray(cache).map(function (key) {\n        return _this6.nodes[key].item;\n      }) : _toConsumableArray(cache));\n    },\n    handleNodeCacheWatcher: function handleNodeCacheWatcher(value, cache, updateFn, emitFn) {\n      var _this7 = this;\n      value = this.returnObject ? value.map(function (v) {\n        return getObjectValueByPath(v, _this7.itemKey);\n      }) : value;\n      var old = _toConsumableArray(cache);\n      if (deepEqual(old, value)) return;\n      old.forEach(function (key) {\n        return updateFn(key, false);\n      });\n      value.forEach(function (key) {\n        return updateFn(key, true);\n      });\n      emitFn();\n    },\n    getDescendants: function getDescendants(key) {\n      var _descendants;\n      var descendants = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      var children = this.nodes[key].children;\n      (_descendants = descendants).push.apply(_descendants, _toConsumableArray(children));\n      for (var i = 0; i < children.length; i++) {\n        descendants = this.getDescendants(children[i], descendants);\n      }\n      return descendants;\n    },\n    getParents: function getParents(key) {\n      var parent = this.nodes[key].parent;\n      var parents = [];\n      while (parent !== null) {\n        parents.push(parent);\n        parent = this.nodes[parent].parent;\n      }\n      return parents;\n    },\n    register: function register(node) {\n      var key = getObjectValueByPath(node.item, this.itemKey);\n      this.nodes[key].vnode = node;\n      this.updateVnodeState(key);\n    },\n    unregister: function unregister(node) {\n      var key = getObjectValueByPath(node.item, this.itemKey);\n      if (this.nodes[key]) this.nodes[key].vnode = null;\n    },\n    isParent: function isParent(key) {\n      return this.nodes[key].children && this.nodes[key].children.length;\n    },\n    updateActive: function updateActive(key, isActive) {\n      var _this8 = this;\n      if (!this.nodes.hasOwnProperty(key)) return;\n      if (!this.multipleActive) {\n        this.activeCache.forEach(function (active) {\n          _this8.nodes[active].isActive = false;\n          _this8.updateVnodeState(active);\n          _this8.activeCache[\"delete\"](active);\n        });\n      }\n      var node = this.nodes[key];\n      if (!node) return;\n      if (isActive) this.activeCache.add(key);else this.activeCache[\"delete\"](key);\n      node.isActive = isActive;\n      this.updateVnodeState(key);\n    },\n    updateSelected: function updateSelected(key, isSelected) {\n      var isForced = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      if (!this.nodes.hasOwnProperty(key)) return;\n      var changed = new Map();\n      if (this.selectionType !== 'independent') {\n        var _iterator3 = _createForOfIteratorHelper(this.getDescendants(key)),\n          _step3;\n        try {\n          for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n            var descendant = _step3.value;\n            if (!getObjectValueByPath(this.nodes[descendant].item, this.itemDisabled) || isForced) {\n              this.nodes[descendant].isSelected = isSelected;\n              this.nodes[descendant].isIndeterminate = false;\n              changed.set(descendant, isSelected);\n            }\n          }\n        } catch (err) {\n          _iterator3.e(err);\n        } finally {\n          _iterator3.f();\n        }\n        var calculated = this.calculateState(key, this.nodes);\n        this.nodes[key].isSelected = isSelected;\n        this.nodes[key].isIndeterminate = calculated.isIndeterminate;\n        changed.set(key, isSelected);\n        var _iterator4 = _createForOfIteratorHelper(this.getParents(key)),\n          _step4;\n        try {\n          for (_iterator4.s(); !(_step4 = _iterator4.n()).done;) {\n            var parent = _step4.value;\n            var _calculated = this.calculateState(parent, this.nodes);\n            this.nodes[parent].isSelected = _calculated.isSelected;\n            this.nodes[parent].isIndeterminate = _calculated.isIndeterminate;\n            changed.set(parent, _calculated.isSelected);\n          }\n        } catch (err) {\n          _iterator4.e(err);\n        } finally {\n          _iterator4.f();\n        }\n      } else {\n        this.nodes[key].isSelected = isSelected;\n        this.nodes[key].isIndeterminate = false;\n        changed.set(key, isSelected);\n      }\n      var _iterator5 = _createForOfIteratorHelper(changed.entries()),\n        _step5;\n      try {\n        for (_iterator5.s(); !(_step5 = _iterator5.n()).done;) {\n          var _step5$value = _slicedToArray(_step5.value, 2),\n            _key = _step5$value[0],\n            value = _step5$value[1];\n          this.updateVnodeState(_key);\n          if (this.selectionType === 'leaf' && this.isParent(_key)) continue;\n          value === true ? this.selectedCache.add(_key) : this.selectedCache[\"delete\"](_key);\n        }\n      } catch (err) {\n        _iterator5.e(err);\n      } finally {\n        _iterator5.f();\n      }\n    },\n    updateOpen: function updateOpen(key, isOpen) {\n      var _this9 = this;\n      if (!this.nodes.hasOwnProperty(key)) return;\n      var node = this.nodes[key];\n      var children = getObjectValueByPath(node.item, this.itemChildren);\n      if (children && !children.length && node.vnode && !node.vnode.hasLoaded) {\n        node.vnode.checkChildren().then(function () {\n          return _this9.updateOpen(key, isOpen);\n        });\n      } else if (children && children.length) {\n        node.isOpen = isOpen;\n        node.isOpen ? this.openCache.add(key) : this.openCache[\"delete\"](key);\n        this.updateVnodeState(key);\n      }\n    },\n    updateVnodeState: function updateVnodeState(key) {\n      var node = this.nodes[key];\n      if (node && node.vnode) {\n        node.vnode.isSelected = node.isSelected;\n        node.vnode.isIndeterminate = node.isIndeterminate;\n        node.vnode.isActive = node.isActive;\n        node.vnode.isOpen = node.isOpen;\n      }\n    },\n    isExcluded: function isExcluded(key) {\n      return !!this.search && this.excludedItems.has(key);\n    }\n  },\n  render: function render(h) {\n    var _this10 = this;\n    var children = this.items.length ? this.items.filter(function (item) {\n      return !_this10.isExcluded(getObjectValueByPath(item, _this10.itemKey));\n    }).map(function (item) {\n      var genChild = VTreeviewNode.options.methods.genChild.bind(_this10);\n      return genChild(item, _this10.disabled || getObjectValueByPath(item, _this10.itemDisabled));\n    })\n    /* istanbul ignore next */ : this.$slots[\"default\"]; // TODO: remove type annotation with TS 3.2\n\n    return h('div', {\n      staticClass: 'v-treeview',\n      \"class\": _objectSpread({\n        'v-treeview--hoverable': this.hoverable,\n        'v-treeview--dense': this.dense\n      }, this.themeClasses)\n    }, children);\n  }\n});","map":{"version":3,"names":["VTreeviewNode","VTreeviewNodeProps","Themeable","provide","RegistrableProvide","arrayDiff","deepEqual","getObjectValueByPath","mixins","consoleWarn","filterTreeItems","filterTreeItem","extend","name","treeview","props","_objectSpread","active","type","Array","_default","dense","Boolean","disabled","filter","Function","hoverable","items","multipleActive","open","openAll","returnObject","search","String","value","data","level","activeCache","Set","nodes","openCache","selectedCache","computed","excludedItems","excluded","i","length","itemKey","itemText","itemChildren","watch","handler","_this","oldKeys","Object","keys","map","k","item","newKeys","getKeys","diff","forEach","oldSelectedCache","_toConsumableArray","buildTree","emitSelected","deep","handleNodeCacheWatcher","updateActive","emitActive","updateSelected","updateOpen","emitOpen","created","_this2","getValue","key","_iterator","_createForOfIteratorHelper","_step","s","n","done","err","e","f","_iterator2","_step2","mounted","_this3","$slots","prepend","append","updateAll","methods","_this4","arguments","undefined","push","children","apply","_this5","parent","_a","oldNode","hasOwnProperty","isSelected","isIndeterminate","isActive","isOpen","vnode","node","c","selectionType","_this$calculateState","calculateState","add","updateVnodeState","state","counts","reduce","child","emitNodeCache","event","cache","_this6","$emit","updateFn","emitFn","_this7","v","old","getDescendants","_descendants","descendants","getParents","parents","register","unregister","isParent","_this8","isForced","changed","Map","_iterator3","_step3","descendant","itemDisabled","set","calculated","_iterator4","_step4","_iterator5","entries","_step5","_step5$value","_slicedToArray","_this9","hasLoaded","checkChildren","then","isExcluded","has","render","h","_this10","genChild","options","bind","staticClass","themeClasses"],"sources":["../../../src/components/VTreeview/VTreeview.ts"],"sourcesContent":["// Styles\nimport './VTreeview.sass'\n\n// Types\nimport { VNode, VNodeChildrenArrayContents, PropType } from 'vue'\nimport { PropValidator } from 'vue/types/options'\nimport { TreeviewItemFunction } from 'vuetify/types'\n\n// Components\nimport VTreeviewNode, { VTreeviewNodeProps } from './VTreeviewNode'\n\n// Mixins\nimport Themeable from '../../mixins/themeable'\nimport { provide as RegistrableProvide } from '../../mixins/registrable'\n\n// Utils\nimport {\n  arrayDiff,\n  deepEqual,\n  getObjectValueByPath,\n} from '../../util/helpers'\nimport mixins from '../../util/mixins'\nimport { consoleWarn } from '../../util/console'\nimport {\n  filterTreeItems,\n  filterTreeItem,\n} from './util/filterTreeItems'\n\ntype VTreeviewNodeInstance = InstanceType<typeof VTreeviewNode>\n\ntype NodeCache = Set<string | number>\ntype NodeArray = (string | number)[]\n\ntype NodeState = {\n  parent: number | string | null\n  children: (number | string)[]\n  vnode: VTreeviewNodeInstance | null\n  isActive: boolean\n  isSelected: boolean\n  isIndeterminate: boolean\n  isOpen: boolean\n  item: any\n}\n\nexport default mixins(\n  RegistrableProvide('treeview'),\n  Themeable\n  /* @vue/component */\n).extend({\n  name: 'v-treeview',\n\n  provide (): object {\n    return { treeview: this }\n  },\n\n  props: {\n    active: {\n      type: Array,\n      default: () => ([]),\n    } as PropValidator<NodeArray>,\n    dense: Boolean,\n    disabled: Boolean,\n    filter: Function as PropType<TreeviewItemFunction>,\n    hoverable: Boolean,\n    items: {\n      type: Array,\n      default: () => ([]),\n    } as PropValidator<any[]>,\n    multipleActive: Boolean,\n    open: {\n      type: Array,\n      default: () => ([]),\n    } as PropValidator<NodeArray>,\n    openAll: Boolean,\n    returnObject: {\n      type: Boolean,\n      default: false, // TODO: Should be true in next major\n    },\n    search: String,\n    value: {\n      type: Array,\n      default: () => ([]),\n    } as PropValidator<NodeArray>,\n    ...VTreeviewNodeProps,\n  },\n\n  data: () => ({\n    level: -1,\n    activeCache: new Set() as NodeCache,\n    nodes: {} as Record<string | number, NodeState>,\n    openCache: new Set() as NodeCache,\n    selectedCache: new Set() as NodeCache,\n  }),\n\n  computed: {\n    excludedItems (): Set<string | number> {\n      const excluded = new Set<string|number>()\n\n      if (!this.search) return excluded\n\n      for (let i = 0; i < this.items.length; i++) {\n        filterTreeItems(\n          this.filter || filterTreeItem,\n          this.items[i],\n          this.search,\n          this.itemKey,\n          this.itemText,\n          this.itemChildren,\n          excluded\n        )\n      }\n\n      return excluded\n    },\n  },\n\n  watch: {\n    items: {\n      handler () {\n        const oldKeys = Object.keys(this.nodes).map(k => getObjectValueByPath(this.nodes[k].item, this.itemKey))\n        const newKeys = this.getKeys(this.items)\n        const diff = arrayDiff(newKeys, oldKeys)\n\n        // We only want to do stuff if items have changed\n        if (!diff.length && newKeys.length < oldKeys.length) return\n\n        // If nodes are removed we need to clear them from this.nodes\n        diff.forEach(k => delete this.nodes[k])\n\n        const oldSelectedCache = [...this.selectedCache]\n        this.selectedCache = new Set()\n        this.activeCache = new Set()\n        this.openCache = new Set()\n        this.buildTree(this.items)\n\n        // Only emit selected if selection has changed\n        // as a result of items changing. This fixes a\n        // potential double emit when selecting a node\n        // with dynamic children\n        if (!deepEqual(oldSelectedCache, [...this.selectedCache])) this.emitSelected()\n      },\n      deep: true,\n    },\n    active (value: (string | number | any)[]) {\n      this.handleNodeCacheWatcher(value, this.activeCache, this.updateActive, this.emitActive)\n    },\n    value (value: (string | number | any)[]) {\n      this.handleNodeCacheWatcher(value, this.selectedCache, this.updateSelected, this.emitSelected)\n    },\n    open (value: (string | number | any)[]) {\n      this.handleNodeCacheWatcher(value, this.openCache, this.updateOpen, this.emitOpen)\n    },\n  },\n\n  created () {\n    const getValue = (key: string | number) => this.returnObject ? getObjectValueByPath(key, this.itemKey) : key\n\n    this.buildTree(this.items)\n\n    for (const value of this.value.map(getValue)) {\n      this.updateSelected(value, true, true)\n    }\n\n    for (const active of this.active.map(getValue)) {\n      this.updateActive(active, true)\n    }\n  },\n\n  mounted () {\n    // Save the developer from themselves\n    if (this.$slots.prepend || this.$slots.append) {\n      consoleWarn('The prepend and append slots require a slot-scope attribute', this)\n    }\n\n    if (this.openAll) {\n      this.updateAll(true)\n    } else {\n      this.open.forEach(key => this.updateOpen(this.returnObject ? getObjectValueByPath(key, this.itemKey) : key, true))\n      this.emitOpen()\n    }\n  },\n\n  methods: {\n    /** @public */\n    updateAll (value: boolean) {\n      Object.keys(this.nodes).forEach(key => this.updateOpen(getObjectValueByPath(this.nodes[key].item, this.itemKey), value))\n      this.emitOpen()\n    },\n    getKeys (items: any[], keys: any[] = []) {\n      for (let i = 0; i < items.length; i++) {\n        const key = getObjectValueByPath(items[i], this.itemKey)\n        keys.push(key)\n        const children = getObjectValueByPath(items[i], this.itemChildren)\n        if (children) {\n          keys.push(...this.getKeys(children))\n        }\n      }\n\n      return keys\n    },\n    buildTree (items: any[], parent: (string | number | null) = null) {\n      for (let i = 0; i < items.length; i++) {\n        const item = items[i]\n        const key = getObjectValueByPath(item, this.itemKey)\n        const children = getObjectValueByPath(item, this.itemChildren) ?? []\n        const oldNode = this.nodes.hasOwnProperty(key) ? this.nodes[key] : {\n          isSelected: false, isIndeterminate: false, isActive: false, isOpen: false, vnode: null,\n        } as NodeState\n\n        const node: any = {\n          vnode: oldNode.vnode,\n          parent,\n          children: children.map((c: any) => getObjectValueByPath(c, this.itemKey)),\n          item,\n        }\n\n        this.buildTree(children, key)\n\n        // This fixed bug with dynamic children resetting selected parent state\n        if (\n          this.selectionType !== 'independent' &&\n          parent !== null &&\n          !this.nodes.hasOwnProperty(key) &&\n          this.nodes.hasOwnProperty(parent)\n        ) {\n          node.isSelected = this.nodes[parent].isSelected\n        } else {\n          node.isSelected = oldNode.isSelected\n          node.isIndeterminate = oldNode.isIndeterminate\n        }\n\n        node.isActive = oldNode.isActive\n        node.isOpen = oldNode.isOpen\n\n        this.nodes[key] = node\n\n        if (children.length && this.selectionType !== 'independent') {\n          const { isSelected, isIndeterminate } = this.calculateState(key, this.nodes)\n\n          node.isSelected = isSelected\n          node.isIndeterminate = isIndeterminate\n        }\n\n        // Don't forget to rebuild cache\n        if (this.nodes[key].isSelected && (this.selectionType === 'independent' || node.children.length === 0)) this.selectedCache.add(key)\n        if (this.nodes[key].isActive) this.activeCache.add(key)\n        if (this.nodes[key].isOpen) this.openCache.add(key)\n\n        this.updateVnodeState(key)\n      }\n    },\n    calculateState (node: string | number, state: Record<string | number, NodeState>) {\n      const children = state[node].children\n      const counts = children.reduce((counts: number[], child: string | number) => {\n        counts[0] += +Boolean(state[child].isSelected)\n        counts[1] += +Boolean(state[child].isIndeterminate)\n\n        return counts\n      }, [0, 0])\n\n      const isSelected = !!children.length && counts[0] === children.length\n      const isIndeterminate = !isSelected && (counts[0] > 0 || counts[1] > 0)\n\n      return {\n        isSelected,\n        isIndeterminate,\n      }\n    },\n    emitOpen () {\n      this.emitNodeCache('update:open', this.openCache)\n    },\n    emitSelected () {\n      this.emitNodeCache('input', this.selectedCache)\n    },\n    emitActive () {\n      this.emitNodeCache('update:active', this.activeCache)\n    },\n    emitNodeCache (event: string, cache: NodeCache) {\n      this.$emit(event, this.returnObject ? [...cache].map(key => this.nodes[key].item) : [...cache])\n    },\n    handleNodeCacheWatcher (value: any[], cache: NodeCache, updateFn: Function, emitFn: Function) {\n      value = this.returnObject ? value.map(v => getObjectValueByPath(v, this.itemKey)) : value\n      const old = [...cache]\n      if (deepEqual(old, value)) return\n\n      old.forEach(key => updateFn(key, false))\n      value.forEach(key => updateFn(key, true))\n\n      emitFn()\n    },\n    getDescendants (key: string | number, descendants: NodeArray = []) {\n      const children = this.nodes[key].children\n\n      descendants.push(...children)\n\n      for (let i = 0; i < children.length; i++) {\n        descendants = this.getDescendants(children[i], descendants)\n      }\n\n      return descendants\n    },\n    getParents (key: string | number) {\n      let parent = this.nodes[key].parent\n\n      const parents = []\n      while (parent !== null) {\n        parents.push(parent)\n        parent = this.nodes[parent].parent\n      }\n\n      return parents\n    },\n    register (node: VTreeviewNodeInstance) {\n      const key = getObjectValueByPath(node.item, this.itemKey)\n      this.nodes[key].vnode = node\n\n      this.updateVnodeState(key)\n    },\n    unregister (node: VTreeviewNodeInstance) {\n      const key = getObjectValueByPath(node.item, this.itemKey)\n      if (this.nodes[key]) this.nodes[key].vnode = null\n    },\n    isParent (key: string | number) {\n      return this.nodes[key].children && this.nodes[key].children.length\n    },\n    updateActive (key: string | number, isActive: boolean) {\n      if (!this.nodes.hasOwnProperty(key)) return\n\n      if (!this.multipleActive) {\n        this.activeCache.forEach(active => {\n          this.nodes[active].isActive = false\n          this.updateVnodeState(active)\n          this.activeCache.delete(active)\n        })\n      }\n\n      const node = this.nodes[key]\n      if (!node) return\n\n      if (isActive) this.activeCache.add(key)\n      else this.activeCache.delete(key)\n\n      node.isActive = isActive\n\n      this.updateVnodeState(key)\n    },\n    updateSelected (key: string | number, isSelected: boolean, isForced = false) {\n      if (!this.nodes.hasOwnProperty(key)) return\n\n      const changed = new Map()\n\n      if (this.selectionType !== 'independent') {\n        for (const descendant of this.getDescendants(key)) {\n          if (!getObjectValueByPath(this.nodes[descendant].item, this.itemDisabled) || isForced) {\n            this.nodes[descendant].isSelected = isSelected\n            this.nodes[descendant].isIndeterminate = false\n            changed.set(descendant, isSelected)\n          }\n        }\n\n        const calculated = this.calculateState(key, this.nodes)\n        this.nodes[key].isSelected = isSelected\n        this.nodes[key].isIndeterminate = calculated.isIndeterminate\n        changed.set(key, isSelected)\n\n        for (const parent of this.getParents(key)) {\n          const calculated = this.calculateState(parent, this.nodes)\n          this.nodes[parent].isSelected = calculated.isSelected\n          this.nodes[parent].isIndeterminate = calculated.isIndeterminate\n          changed.set(parent, calculated.isSelected)\n        }\n      } else {\n        this.nodes[key].isSelected = isSelected\n        this.nodes[key].isIndeterminate = false\n        changed.set(key, isSelected)\n      }\n\n      for (const [key, value] of changed.entries()) {\n        this.updateVnodeState(key)\n\n        if (this.selectionType === 'leaf' && this.isParent(key)) continue\n\n        value === true ? this.selectedCache.add(key) : this.selectedCache.delete(key)\n      }\n    },\n    updateOpen (key: string | number, isOpen: boolean) {\n      if (!this.nodes.hasOwnProperty(key)) return\n\n      const node = this.nodes[key]\n      const children = getObjectValueByPath(node.item, this.itemChildren)\n\n      if (children && !children.length && node.vnode && !node.vnode.hasLoaded) {\n        node.vnode.checkChildren().then(() => this.updateOpen(key, isOpen))\n      } else if (children && children.length) {\n        node.isOpen = isOpen\n\n        node.isOpen ? this.openCache.add(key) : this.openCache.delete(key)\n\n        this.updateVnodeState(key)\n      }\n    },\n    updateVnodeState (key: string | number) {\n      const node = this.nodes[key]\n\n      if (node && node.vnode) {\n        node.vnode.isSelected = node.isSelected\n        node.vnode.isIndeterminate = node.isIndeterminate\n        node.vnode.isActive = node.isActive\n        node.vnode.isOpen = node.isOpen\n      }\n    },\n    isExcluded (key: string | number) {\n      return !!this.search && this.excludedItems.has(key)\n    },\n  },\n\n  render (h): VNode {\n    const children: VNodeChildrenArrayContents = this.items.length\n      ? this.items.filter(item => {\n        return !this.isExcluded(getObjectValueByPath(item, this.itemKey))\n      }).map(item => {\n        const genChild = VTreeviewNode.options.methods.genChild.bind(this)\n\n        return genChild(item, this.disabled || getObjectValueByPath(item, this.itemDisabled))\n      })\n      /* istanbul ignore next */\n      : this.$slots.default! // TODO: remove type annotation with TS 3.2\n\n    return h('div', {\n      staticClass: 'v-treeview',\n      class: {\n        'v-treeview--hoverable': this.hoverable,\n        'v-treeview--dense': this.dense,\n        ...this.themeClasses,\n      },\n    }, children)\n  },\n})\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}